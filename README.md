# Turborepo + Pothos + Prisma + Next Template

## Technology stack

- Backend: [Node.js](https://nodejs.org/en/), [Pothos GraphQL](https://pothos-graphql.dev/), [Prisma](https://www.prisma.io/) and [Apollo Server](https://www.apollographql.com/docs/apollo-server/#:~:text=Apollo%20Server%20is%20an%20open,use%20data%20from%20any%20source.)
- Frontend: [React.js](https://reactjs.org/), [Next.js](https://nextjs.org/) and [Apollo Client](https://www.apollographql.com/docs/react/)

## Monorepo Setup

- `apps/api`: [Node.js](https://nodejs.org/en/) app, provides all the apis and connects to the database.
- `apps/web`: Main app powered by [Next.js](https://nextjs.org)
- `apps/admin`: [Next.js](https://nextjs.org) app for admin purposes
- `packages/ui`: Internal component library used by both `web` and `admin` applications
- `packages/apollo-hooks`: Libary of apollo-graphql hooks generated by [GraphQL Code Generator](https://www.graphql-code-generator.com/) for `web` and `admin` app to consume

## Requirements

- ### General

  - **Yarn**

  This repository uses [Yarn](https://classic.yarnpkg.com/lang/en/) as a package manager.

- ### Backend

  - **PostgreSQL Database**

    To run the backend, a connection to a database is needed. The easiest way to run a Postgres DB locally is via [Docker](https://www.docker.com/).

    Once you have Docker installed run this command:

    ```
    docker run --detach --publish 5432:5432 -e POSTGRES_PASSWORD=postgres --name turbo-pothos-template-prisma-next-js postgres:10.12
    ```

    Another alternative is running a PostgreSQL DB in the cloud with services like [fly.io](https://fly.io/) or [Heroku](https://dashboard.heroku.com) wich have a a free tier.

  - **Cloudinary**

    All the images are saved in [Cloudinary](https://cloudinary.com/), the free tier is more than enough for development.

  - **Enviroment Variables**

    Inside the `apps/api` directory

    ```
    DATABASE_URL="database url, if running with docker it would be: postgresql://postgres:postgres@localhost:5432/your-db"
    CLOUDINARY_URL="Your Cloudinary key goes here"
    JWT_SECRET="Any random string, only for development"
    SERVER_URL="http://localhost"
    ```

- ### Frontend

  - **Enviroment Variables**

    Inside the `apps/web` and `apps/admin` directories

    ```
    NEXT_PUBLIC_SERVER_URL="http://localhost:8080/graphql"
    ```

## Running the app

- To install project deps, run

  ```
  yarn app:install
  ```

- Initialize the database or sync the database schema

  ```
  yarn db:push
  ```

- Generate the pr the prismas client and types

  ```
  yarn db:generate
  ```

- Generate the apollo hooks

  ```
  yarn apollo:generate
  ```

- Run app

  - Start the backend

    ```
    yarn dev:api
    ```

  - Start backend + web

    ```
    yarn dev:web
    ```

  - Start backend + admin

    ```
    yarn dev:admin
    ```

  - Start backed + admin + web
    ```
    yarn dev
    ```
